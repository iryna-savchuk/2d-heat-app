<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="/static/favicon.ico" type="image/x-icon">
    <title>Plotting Temperature Prediction</title>
    <!-- Bootstrap CSS CDN -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom CSS for font-family -->
    <style>
        body {
            font-family: 'Avenir', sans-serif;
        }
        /* Custom CSS to adjust layout */
        #plot {
            border: 1px solid #ccc;
            padding: 10px;
            min-height: 400px; /* Set a minimum height for the plot container */
            min-width: 600px;
        }
    </style>
</head>

<body>
    <div class="container mt-5">
        <h1 class="text-center mb-4">Plotting Temperature Prediction</h1>
        
        <!-- Link to FastAPI /docs endpoint -->
        <div class="container mt-3">
            <div class="text-right">
                <a href="/docs" class="btn btn-link" style="opacity: 0.7;" target="_blank"> See FastAPI Endpoints</a>
            </div>
        </div>

        <div class="row">
            <!-- Form column -->
            <div class="col-md-4">
                <form id="predictionForm" class="mb-5">
                    <div class="form-group row">
                        <label for="value1" class="col-sm-4 col-form-label">T_ambient:</label>
                        <div class="col-sm-8">
                            <input type="float" class="form-control" id="value1" name="value1" value="25" required>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="value2" class="col-sm-4 col-form-label">T_left:</label>
                        <div class="col-sm-8">
                            <input type="float" class="form-control" id="value2" name="value2" value="100" required>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="value3" class="col-sm-4 col-form-label">T_right:</label>
                        <div class="col-sm-8">
                            <input type="float" class="form-control" id="value3" name="value3" value="50" required>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="value4" class="col-sm-4 col-form-label">k:</label>
                        <div class="col-sm-8">
                            <input type="float" class="form-control" id="value4" name="value4" value="0.01" required>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="value5" class="col-sm-4 col-form-label">low_k:</label>
                        <div class="col-sm-8">
                            <input type="float" class="form-control" id="value5" name="value5" value="0.003" required>
                        </div>
                    </div>
                    <!-- Add input fields for other values as needed -->

                    <div class="form-group row">
                        <div class="col-sm-10 offset-sm-4">
                            <button type="submit" class="btn btn-primary">Plot Prediction</button>
                        </div>
                    </div>
                </form>
            </div>      
            <!-- Plot column -->
            <div class="col-md-8">
                <div id="plot"></div>
            </div>
        </div>
    </div>


   <!-- Include any JavaScript code here -->
    <script>
        // Function to handle form submission
        document.getElementById("predictionForm").addEventListener("submit", function(event) {
            event.preventDefault(); // Prevent default form submission
            plot(); // Call the predict function
        });

        // Function to send prediction request to the server
       // Function to send prediction request to the server
    function plot() {
        // Get input values from the form
        const value1 = document.getElementById("value1").value;
        const value2 = document.getElementById("value2").value;
        const value3 = document.getElementById("value3").value;
        const value4 = document.getElementById("value4").value;
        const value5 = document.getElementById("value5").value;

        // Create a list of values
        const values = [parseFloat(value1), parseFloat(value2), parseFloat(value3), parseFloat(value4), parseFloat(value5)];

        // Send AJAX request to the server
        fetch('/plot/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(values) // Pass the list directly
        })
        .then(response => response.blob()) // Get the response as blob
        .then(blob => {
            // Create URL for the blob
            const blobUrl = URL.createObjectURL(blob);

            // Display the plot
            document.getElementById("plot").innerHTML = `<img src="${blobUrl}" alt="Prediction Plot">`;
        })
        .catch(error => console.error('Error:', error));
    }

    </script>

</body>
</html>